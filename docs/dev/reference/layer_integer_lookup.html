<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>A preprocessing layer that maps integers to (possibly encoded) indices. — layer_integer_lookup • keras3</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="A preprocessing layer that maps integers to (possibly encoded) indices. — layer_integer_lookup"><meta name="description" content="This layer maps a set of arbitrary integer input tokens into indexed integer
output via a table-based vocabulary lookup. The layer's output indices will
be contiguously arranged up to the maximum vocab size, even if the input
tokens are non-continguous or unbounded. The layer supports multiple options
for encoding the output via output_mode, and has optional support for
out-of-vocabulary (OOV) tokens and masking.
The vocabulary for the layer must be either supplied on construction or
learned via adapt(). During adapt(), the layer will analyze a data set,
determine the frequency of individual integer tokens, and create a
vocabulary from them. If the vocabulary is capped in size, the most frequent
tokens will be used to create the vocabulary and all others will be treated
as OOV.
There are two possible output modes for the layer.  When output_mode is
&quot;int&quot;, input integers are converted to their index in the vocabulary (an
integer).  When output_mode is &quot;multi_hot&quot;, &quot;count&quot;, or &quot;tf_idf&quot;,
input integers are encoded into an array where each dimension corresponds to
an element in the vocabulary.
The vocabulary can optionally contain a mask token as well as an OOV token
(which can optionally occupy multiple indices in the vocabulary, as set
by num_oov_indices).
The position of these tokens in the vocabulary is fixed. When output_mode
is &quot;int&quot;, the vocabulary will begin with the mask token at index 0,
followed by OOV indices, followed by the rest of the vocabulary. When
output_mode is &quot;multi_hot&quot;, &quot;count&quot;, or &quot;tf_idf&quot; the vocabulary will
begin with OOV indices and instances of the mask token will be dropped.
Note: This layer uses TensorFlow internally. It cannot
be used as part of the compiled computation graph of a model with
any backend other than TensorFlow.
It can however be used with any backend when running eagerly.
It can also always be used as part of an input preprocessing pipeline
with any backend (outside the model itself), which is how we recommend
to use this layer.
Note: This layer is safe to use inside a tf.data pipeline
(independently of which backend you're using)."><meta property="og:description" content="This layer maps a set of arbitrary integer input tokens into indexed integer
output via a table-based vocabulary lookup. The layer's output indices will
be contiguously arranged up to the maximum vocab size, even if the input
tokens are non-continguous or unbounded. The layer supports multiple options
for encoding the output via output_mode, and has optional support for
out-of-vocabulary (OOV) tokens and masking.
The vocabulary for the layer must be either supplied on construction or
learned via adapt(). During adapt(), the layer will analyze a data set,
determine the frequency of individual integer tokens, and create a
vocabulary from them. If the vocabulary is capped in size, the most frequent
tokens will be used to create the vocabulary and all others will be treated
as OOV.
There are two possible output modes for the layer.  When output_mode is
&quot;int&quot;, input integers are converted to their index in the vocabulary (an
integer).  When output_mode is &quot;multi_hot&quot;, &quot;count&quot;, or &quot;tf_idf&quot;,
input integers are encoded into an array where each dimension corresponds to
an element in the vocabulary.
The vocabulary can optionally contain a mask token as well as an OOV token
(which can optionally occupy multiple indices in the vocabulary, as set
by num_oov_indices).
The position of these tokens in the vocabulary is fixed. When output_mode
is &quot;int&quot;, the vocabulary will begin with the mask token at index 0,
followed by OOV indices, followed by the rest of the vocabulary. When
output_mode is &quot;multi_hot&quot;, &quot;count&quot;, or &quot;tf_idf&quot; the vocabulary will
begin with OOV indices and instances of the mask token will be dropped.
Note: This layer uses TensorFlow internally. It cannot
be used as part of the compiled computation graph of a model with
any backend other than TensorFlow.
It can however be used with any backend when running eagerly.
It can also always be used as part of an input preprocessing pipeline
with any backend (outside the model itself), which is how we recommend
to use this layer.
Note: This layer is safe to use inside a tf.data pipeline
(independently of which backend you're using)."><meta name="robots" content="noindex"><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KHBDBW7');</script><!-- End Google Tag Manager --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHBDBW7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) -->


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">keras3</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/getting_started.html">Getting Started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-guides"><li><h6 class="dropdown-header" data-toc-skip>Model definition</h6></li>
    <li><a class="dropdown-item" href="../articles/sequential_model.html">Sequential Model</a></li>
    <li><a class="dropdown-item" href="../articles/functional_api.html">Functional API</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extending and customizing</h6></li>
    <li><a class="dropdown-item" href="../articles/training_with_built_in_methods.html">Training &amp; evaluation with the built-in methods</a></li>
    <li><a class="dropdown-item" href="../articles/custom_train_step_in_tensorflow.html">Customizing `fit()` with Tensorflow</a></li>
    <li><a class="dropdown-item" href="../articles/writing_your_own_callbacks.html">Writing your own callbacks</a></li>
    <li><a class="dropdown-item" href="../articles/making_new_layers_and_models_via_subclassing.html">Making new layers and models via subclassing</a></li>
    <li><a class="dropdown-item" href="../articles/writing_a_custom_training_loop_in_tensorflow.html">Writing a training loop from scratch in TensorFlow</a></li>
    <li><a class="dropdown-item" href="../articles/serialization_and_saving.html">Serialization and Saving</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other topics</h6></li>
    <li><a class="dropdown-item" href="../articles/transfer_learning.html">Transfer learning and fine tuning</a></li>
    <li><a class="dropdown-item" href="../articles/distributed_training_with_tensorflow.html">Distributed training with TensorFlow</a></li>
    <li><a class="dropdown-item" href="../articles/distribution.html">Distributed training with Jax</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/examples/index.html">Examples</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/keras3/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>A preprocessing layer that maps integers to (possibly encoded) indices.</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/keras3/blob/HEAD/R/layers-preprocessing.R" class="external-link"><code>R/layers-preprocessing.R</code></a></small>
      <div class="d-none name"><code>layer_integer_lookup.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This layer maps a set of arbitrary integer input tokens into indexed integer
output via a table-based vocabulary lookup. The layer's output indices will
be contiguously arranged up to the maximum vocab size, even if the input
tokens are non-continguous or unbounded. The layer supports multiple options
for encoding the output via <code>output_mode</code>, and has optional support for
out-of-vocabulary (OOV) tokens and masking.</p>
<p>The vocabulary for the layer must be either supplied on construction or
learned via <code><a href="adapt.html">adapt()</a></code>. During <code><a href="adapt.html">adapt()</a></code>, the layer will analyze a data set,
determine the frequency of individual integer tokens, and create a
vocabulary from them. If the vocabulary is capped in size, the most frequent
tokens will be used to create the vocabulary and all others will be treated
as OOV.</p>
<p>There are two possible output modes for the layer.  When <code>output_mode</code> is
<code>"int"</code>, input integers are converted to their index in the vocabulary (an
integer).  When <code>output_mode</code> is <code>"multi_hot"</code>, <code>"count"</code>, or <code>"tf_idf"</code>,
input integers are encoded into an array where each dimension corresponds to
an element in the vocabulary.</p>
<p>The vocabulary can optionally contain a mask token as well as an OOV token
(which can optionally occupy multiple indices in the vocabulary, as set
by <code>num_oov_indices</code>).
The position of these tokens in the vocabulary is fixed. When <code>output_mode</code>
is <code>"int"</code>, the vocabulary will begin with the mask token at index 0,
followed by OOV indices, followed by the rest of the vocabulary. When
<code>output_mode</code> is <code>"multi_hot"</code>, <code>"count"</code>, or <code>"tf_idf"</code> the vocabulary will
begin with OOV indices and instances of the mask token will be dropped.</p>
<p><strong>Note:</strong> This layer uses TensorFlow internally. It cannot
be used as part of the compiled computation graph of a model with
any backend other than TensorFlow.
It can however be used with any backend when running eagerly.
It can also always be used as part of an input preprocessing pipeline
with any backend (outside the model itself), which is how we recommend
to use this layer.</p>
<p><strong>Note:</strong> This layer is safe to use inside a <code>tf.data</code> pipeline
(independently of which backend you're using).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">layer_integer_lookup</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  max_tokens <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_oov_indices <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  mask_token <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oov_token <span class="op">=</span> <span class="op">-</span><span class="fl">1L</span>,</span>
<span>  vocabulary <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vocabulary_dtype <span class="op">=</span> <span class="st">"int64"</span>,</span>
<span>  idf_weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  invert <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_mode <span class="op">=</span> <span class="st">"int"</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pad_to_max_tokens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>Object to compose the layer with. A tensor, array, or sequential model.</p></dd>


<dt id="arg-max-tokens">max_tokens<a class="anchor" aria-label="anchor" href="#arg-max-tokens"></a></dt>
<dd><p>Maximum size of the vocabulary for this layer. This should
only be specified when adapting the vocabulary or when setting
<code>pad_to_max_tokens=TRUE</code>. If NULL, there is no cap on the size of
the vocabulary. Note that this size includes the OOV
and mask tokens. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-num-oov-indices">num_oov_indices<a class="anchor" aria-label="anchor" href="#arg-num-oov-indices"></a></dt>
<dd><p>The number of out-of-vocabulary tokens to use.
If this value is more than 1, OOV inputs are modulated to
determine their OOV value.
If this value is 0, OOV inputs will cause an error when calling
the layer. Defaults to <code>1</code>.</p></dd>


<dt id="arg-mask-token">mask_token<a class="anchor" aria-label="anchor" href="#arg-mask-token"></a></dt>
<dd><p>An integer token that represents masked inputs. When
<code>output_mode</code> is <code>"int"</code>, the token is included in vocabulary
and mapped to index 0. In other output modes,
the token will not appear in the vocabulary and instances
of the mask token in the input will be dropped.
If set to NULL, no mask term will be added. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-oov-token">oov_token<a class="anchor" aria-label="anchor" href="#arg-oov-token"></a></dt>
<dd><p>Only used when <code>invert</code> is <code>TRUE</code>. The token to return
for OOV indices. Defaults to <code>-1</code>.</p></dd>


<dt id="arg-vocabulary">vocabulary<a class="anchor" aria-label="anchor" href="#arg-vocabulary"></a></dt>
<dd><p>Optional. Either an array of integers or a string path to a
text file. If passing an array, can pass a list, list,
1D NumPy array, or 1D tensor containing the integer vocbulary terms.
If passing a file path, the file should contain one line per term
in the vocabulary. If this argument is set,
there is no need to <code><a href="adapt.html">adapt()</a></code> the layer.</p></dd>


<dt id="arg-vocabulary-dtype">vocabulary_dtype<a class="anchor" aria-label="anchor" href="#arg-vocabulary-dtype"></a></dt>
<dd><p>The dtype of the vocabulary terms, for example
<code>"int64"</code> or <code>"int32"</code>. Defaults to <code>"int64"</code>.</p></dd>


<dt id="arg-idf-weights">idf_weights<a class="anchor" aria-label="anchor" href="#arg-idf-weights"></a></dt>
<dd><p>Only valid when <code>output_mode</code> is <code>"tf_idf"</code>.
A list, list, 1D NumPy array, or 1D tensor or the same length
as the vocabulary, containing the floating point inverse document
frequency weights, which will be multiplied by per sample term
counts for the final TF-IDF weight.
If the <code>vocabulary</code> argument is set, and <code>output_mode</code> is
<code>"tf_idf"</code>, this argument must be supplied.</p></dd>


<dt id="arg-invert">invert<a class="anchor" aria-label="anchor" href="#arg-invert"></a></dt>
<dd><p>Only valid when <code>output_mode</code> is <code>"int"</code>.
If <code>TRUE</code>, this layer will map indices to vocabulary items
instead of mapping vocabulary items to indices.
Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-output-mode">output_mode<a class="anchor" aria-label="anchor" href="#arg-output-mode"></a></dt>
<dd><p>Specification for the output of the layer. Values can be
<code>"int"</code>, <code>"one_hot"</code>, <code>"multi_hot"</code>, <code>"count"</code>, or <code>"tf_idf"</code>
configuring the layer as follows:</p><ul><li><p><code>"int"</code>: Return the vocabulary indices of the input tokens.</p></li>
<li><p><code>"one_hot"</code>: Encodes each individual element in the input into an
array the same size as the vocabulary,
containing a 1 at the element index. If the last dimension
is size 1, will encode on that dimension.
If the last dimension is not size 1, will append a new
dimension for the encoded output.</p></li>
<li><p><code>"multi_hot"</code>: Encodes each sample in the input into a single
array the same size as the vocabulary,
containing a 1 for each vocabulary term present in the sample.
Treats the last dimension as the sample dimension,
if input shape is <code>(..., sample_length)</code>,
output shape will be <code>(..., num_tokens)</code>.</p></li>
<li><p><code>"count"</code>: As <code>"multi_hot"</code>, but the int array contains
a count of the number of times the token at that index
appeared in the sample.</p></li>
<li><p><code>"tf_idf"</code>: As <code>"multi_hot"</code>, but the TF-IDF algorithm is
applied to find the value in each token slot.
For <code>"int"</code> output, any shape of input and output is supported.
For all other output modes, currently only output up to rank 2
is supported. Defaults to <code>"int"</code>.</p></li>
</ul></dd>


<dt id="arg-sparse">sparse<a class="anchor" aria-label="anchor" href="#arg-sparse"></a></dt>
<dd><p>Boolean. Only applicable to <code>"multi_hot"</code>, <code>"count"</code>, and
<code>"tf_idf"</code> output modes. Only supported with TensorFlow
backend. If <code>TRUE</code>, returns a <code>SparseTensor</code>
instead of a dense <code>Tensor</code>. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-pad-to-max-tokens">pad_to_max_tokens<a class="anchor" aria-label="anchor" href="#arg-pad-to-max-tokens"></a></dt>
<dd><p>Only applicable when <code>output_mode</code> is <code>"multi_hot"</code>,
<code>"count"</code>, or <code>"tf_idf"</code>. If <code>TRUE</code>, the output will have
its feature axis padded to <code>max_tokens</code> even if the number
of unique tokens in the vocabulary is less than <code>max_tokens</code>,
resulting in a tensor of shape <code>(batch_size, max_tokens)</code>
regardless of vocabulary size. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>String, name for the object</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For forward/backward compatability.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The return value depends on the value provided for the first argument.
If  <code>object</code> is:</p><ul><li><p>a <code><a href="keras_model_sequential.html">keras_model_sequential()</a></code>, then the layer is added to the sequential model
(which is modified in place). To enable piping, the sequential model is also
returned, invisibly.</p></li>
<li><p>a <code><a href="keras_input.html">keras_input()</a></code>, then the output tensor from calling <code>layer(input)</code> is returned.</p></li>
<li><p><code>NULL</code> or missing, then a <code>Layer</code> instance is returned.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>
    <p><strong>Creating a lookup layer with a known vocabulary</strong></p>
<p>This example creates a lookup layer with a pre-existing vocabulary.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">vocab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">1000</span>, <span class="fl">36</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Note OOV tokens</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>vocabulary <span class="op">=</span> <span class="va">vocab</span><span class="op">)</span></span>
<span><span class="va">out</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[1 3 4]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [4 0 2]], shape=(2, 3), dtype=int64)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre><p></p></div>
<p><strong>Creating a lookup layer with an adapted vocabulary</strong></p>
<p>This example creates a lookup layer and generates the vocabulary by
analyzing the dataset.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">1000</span>, <span class="fl">36</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Note OOV tokens</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">layer</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/adapt.html">adapt</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">layer</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/layer_text_vectorization.html">get_vocabulary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## List of 6</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">##  $ : int -1</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  $ : num 42</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="do">##  $ : num 1138</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">##  $ : num 1000</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="do">##  $ : num 36</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="do">##  $ : num 12</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span></code></pre><p></p></div>
<p>Note that the OOV token -1 have been added to the vocabulary. The remaining
tokens are sorted by frequency (42, which has 2 occurrences, is first) then
by inverse sort order.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu">layer</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[5 2 1]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [1 3 4]], shape=(2, 3), dtype=int64)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre><p></p></div>
<p><strong>Lookups with multiple OOV indices</strong></p>
<p>This example demonstrates how to use a lookup layer with multiple OOV
indices.  When a layer is created with more than one OOV index, any OOV
tokens are hashed into the number of OOV buckets, distributing OOV tokens in
a deterministic fashion across the set.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">vocab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37</span>, <span class="fl">1000</span>, <span class="fl">36</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Note OOV tokens</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>vocabulary <span class="op">=</span> <span class="va">vocab</span>,</span>
<span>                       num_oov_indices <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">out</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[2 4 5]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [1 0 3]], shape=(2, 3), dtype=int64)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre><p></p></div>
<p>Note that the output for OOV token 37 is 1, while the output for OOV token
1000 is 0. The in-vocab terms have their output index increased by 1 from
earlier examples (12 maps to 2, etc) in order to make space for the extra
OOV token.</p>
<p><strong>One-hot output</strong></p>
<p>Configure the layer with <code>output_mode='one_hot'</code>. Note that the first
<code>num_oov_indices</code> dimensions in the ont_hot encoding represent OOV values.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">vocab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span>, <span class="fl">7</span><span class="op">)</span>, <span class="st">'int32'</span><span class="op">)</span>  <span class="co"># Note OOV tokens</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>vocabulary <span class="op">=</span> <span class="va">vocab</span>,</span>
<span>                              output_mode <span class="op">=</span> <span class="st">'one_hot'</span><span class="op">)</span></span>
<span><span class="fu">layer</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[0 1 0 0 0]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [0 0 1 0 0]</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="do">##  [0 0 0 1 0]</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">##  [0 0 0 0 1]</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="do">##  [1 0 0 0 0]], shape=(5, 5), dtype=int64)</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span></code></pre><p></p></div>
<p><strong>Multi-hot output</strong></p>
<p>Configure the layer with <code>output_mode = 'multi_hot'</code>. Note that the first
<code>num_oov_indices</code> dimensions in the multi_hot encoding represent OOV tokens</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">vocab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1138</span>, <span class="fl">42</span>, <span class="fl">42</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>,    <span class="fl">7</span>, <span class="fl">36</span>,  <span class="fl">7</span><span class="op">)</span><span class="op">)</span>, <span class="st">"int64"</span><span class="op">)</span>  <span class="co"># Note OOV tokens</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>vocabulary <span class="op">=</span> <span class="va">vocab</span>,</span>
<span>                              output_mode <span class="op">=</span> <span class="st">'multi_hot'</span><span class="op">)</span></span>
<span><span class="fu">layer</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[0 1 0 1 1]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [1 0 1 0 1]], shape=(2, 5), dtype=int64)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre><p></p></div>
<p><strong>Token count output</strong></p>
<p>Configure the layer with <code>output_mode='count'</code>. As with multi_hot output,
the first <code>num_oov_indices</code> dimensions in the output represent OOV tokens.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">vocab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1138</span>, <span class="fl">42</span>, <span class="fl">42</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>,    <span class="fl">7</span>, <span class="fl">36</span>,  <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="st">"int64"</span><span class="op">)</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>vocabulary <span class="op">=</span> <span class="va">vocab</span>,</span>
<span>                              output_mode <span class="op">=</span> <span class="st">'count'</span><span class="op">)</span></span>
<span><span class="fu">layer</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[0 1 0 1 2]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [2 0 1 0 1]], shape=(2, 5), dtype=int64)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre><p></p></div>
<p><strong>TF-IDF output</strong></p>
<p>Configure the layer with <code>output_mode='tf_idf'</code>. As with multi_hot output,
the first <code>num_oov_indices</code> dimensions in the output represent OOV tokens.</p>
<p>Each token bin will output <code>token_count * idf_weight</code>, where the idf weights
are the inverse document frequency weights per token. These should be
provided along with the vocabulary. Note that the <code>idf_weight</code> for OOV
tokens will default to the average of all idf weights passed in.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">vocab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">idf_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1138</span>, <span class="fl">42</span>, <span class="fl">42</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>,    <span class="fl">7</span>, <span class="fl">36</span>,  <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="st">"int64"</span><span class="op">)</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>output_mode <span class="op">=</span> <span class="st">'tf_idf'</span>,</span>
<span>                              vocabulary <span class="op">=</span> <span class="va">vocab</span>,</span>
<span>                              idf_weights <span class="op">=</span> <span class="va">idf_weights</span><span class="op">)</span></span>
<span><span class="fu">layer</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[0.   0.25 0.   0.6  0.8 ]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [1.   0.   0.75 0.   0.4 ]], shape=(2, 5), dtype=float32)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre><p></p></div>
<p>To specify the idf weights for oov tokens, you will need to pass the entire
vocabulary including the leading oov token.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">vocab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">idf_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1138</span>, <span class="fl">42</span>, <span class="fl">42</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>,    <span class="fl">7</span>, <span class="fl">36</span>,  <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="st">"int64"</span><span class="op">)</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>output_mode <span class="op">=</span> <span class="st">'tf_idf'</span>,</span>
<span>                              vocabulary <span class="op">=</span> <span class="va">vocab</span>,</span>
<span>                              idf_weights <span class="op">=</span> <span class="va">idf_weights</span><span class="op">)</span></span>
<span><span class="fu">layer</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[0.   0.25 0.   0.6  0.8 ]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [1.8  0.   0.75 0.   0.4 ]], shape=(2, 5), dtype=float32)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre><p></p></div>
<p>When adapting the layer in <code>"tf_idf"</code> mode, each input sample will
be considered a document, and IDF weight per token will be
calculated as:
<code>log(1 + num_documents / (1 + token_document_count))</code>.</p>
<p><strong>Inverse lookup</strong></p>
<p>This example demonstrates how to map indices to tokens using this layer.
(You can also use <code><a href="adapt.html">adapt()</a></code> with <code>inverse = TRUE</code>, but for simplicity we'll
pass the vocab in this example.)</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">vocab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span>,</span>
<span>                  <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/op_reshape.html">op_reshape</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/op_cast.html">op_cast</a></span><span class="op">(</span><span class="st">"int32"</span><span class="op">)</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>vocabulary <span class="op">=</span> <span class="va">vocab</span>, invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">layer</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[  12 1138   42]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [  42   -1   36]], shape=(2, 3), dtype=int64)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre><p></p></div>
<p>Note that the first index correspond to the oov token by default.</p>
<p><strong>Forward and inverse lookup pairs</strong></p>
<p>This example demonstrates how to use the vocabulary of a standard lookup
layer to create an inverse lookup layer.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">vocab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/op_array.html">op_array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1138</span>, <span class="fl">42</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">1000</span>, <span class="fl">36</span><span class="op">)</span><span class="op">)</span>, <span class="st">"int32"</span><span class="op">)</span></span>
<span><span class="va">layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>vocabulary <span class="op">=</span> <span class="va">vocab</span><span class="op">)</span></span>
<span><span class="va">i_layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layer_integer_lookup.html">layer_integer_lookup</a></span><span class="op">(</span>vocabulary <span class="op">=</span> <span class="fu"><a href="../reference/layer_text_vectorization.html">get_vocabulary</a></span><span class="op">(</span><span class="va">layer</span><span class="op">)</span>,</span>
<span>                                invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">int_data</span> <span class="op">&lt;-</span> <span class="fu">layer</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="fu">i_layer</span><span class="op">(</span><span class="va">int_data</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## tf.Tensor(</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [[  12 1138   42]</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">##  [  42   -1   36]], shape=(2, 3), dtype=int64)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span></code></pre><p></p></div>
<p>In this example, the input token 1000 resulted in an output of -1, since
1000 was not in the vocabulary - it got represented as an OOV, and all OOV
tokens are returned as -1 in the inverse layer. Also, note that for the
inverse to work, you must have already set the forward layer vocabulary
either directly or via <code><a href="adapt.html">adapt()</a></code> before calling <code><a href="layer_text_vectorization.html">get_vocabulary()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><a href="https://keras.io/api/layers/preprocessing_layers/categorical/integer_lookup#integerlookup-class" class="external-link">https://keras.io/api/layers/preprocessing_layers/categorical/integer_lookup#integerlookup-class</a></p></li>
</ul><p>Other categorical features preprocessing layers: <br><code><a href="layer_category_encoding.html">layer_category_encoding</a>()</code> <br><code><a href="layer_hashed_crossing.html">layer_hashed_crossing</a>()</code> <br><code><a href="layer_hashing.html">layer_hashing</a>()</code> <br><code><a href="layer_string_lookup.html">layer_string_lookup</a>()</code> <br></p>
<p>Other preprocessing layers: <br><code><a href="layer_category_encoding.html">layer_category_encoding</a>()</code> <br><code><a href="layer_center_crop.html">layer_center_crop</a>()</code> <br><code><a href="layer_discretization.html">layer_discretization</a>()</code> <br><code><a href="layer_feature_space.html">layer_feature_space</a>()</code> <br><code><a href="layer_hashed_crossing.html">layer_hashed_crossing</a>()</code> <br><code><a href="layer_hashing.html">layer_hashing</a>()</code> <br><code><a href="layer_mel_spectrogram.html">layer_mel_spectrogram</a>()</code> <br><code><a href="layer_normalization.html">layer_normalization</a>()</code> <br><code><a href="layer_random_brightness.html">layer_random_brightness</a>()</code> <br><code><a href="layer_random_contrast.html">layer_random_contrast</a>()</code> <br><code><a href="layer_random_crop.html">layer_random_crop</a>()</code> <br><code><a href="layer_random_flip.html">layer_random_flip</a>()</code> <br><code><a href="layer_random_rotation.html">layer_random_rotation</a>()</code> <br><code><a href="layer_random_translation.html">layer_random_translation</a>()</code> <br><code><a href="layer_random_zoom.html">layer_random_zoom</a>()</code> <br><code><a href="layer_rescaling.html">layer_rescaling</a>()</code> <br><code><a href="layer_resizing.html">layer_resizing</a>()</code> <br><code><a href="layer_string_lookup.html">layer_string_lookup</a>()</code> <br><code><a href="layer_text_vectorization.html">layer_text_vectorization</a>()</code> <br></p>
<p>Other layers: <br><code><a href="Layer.html">Layer</a>()</code> <br><code><a href="layer_activation.html">layer_activation</a>()</code> <br><code><a href="layer_activation_elu.html">layer_activation_elu</a>()</code> <br><code><a href="layer_activation_leaky_relu.html">layer_activation_leaky_relu</a>()</code> <br><code><a href="layer_activation_parametric_relu.html">layer_activation_parametric_relu</a>()</code> <br><code><a href="layer_activation_relu.html">layer_activation_relu</a>()</code> <br><code><a href="layer_activation_softmax.html">layer_activation_softmax</a>()</code> <br><code><a href="layer_activity_regularization.html">layer_activity_regularization</a>()</code> <br><code><a href="layer_add.html">layer_add</a>()</code> <br><code><a href="layer_additive_attention.html">layer_additive_attention</a>()</code> <br><code><a href="layer_alpha_dropout.html">layer_alpha_dropout</a>()</code> <br><code><a href="layer_attention.html">layer_attention</a>()</code> <br><code><a href="layer_average.html">layer_average</a>()</code> <br><code><a href="layer_average_pooling_1d.html">layer_average_pooling_1d</a>()</code> <br><code><a href="layer_average_pooling_2d.html">layer_average_pooling_2d</a>()</code> <br><code><a href="layer_average_pooling_3d.html">layer_average_pooling_3d</a>()</code> <br><code><a href="layer_batch_normalization.html">layer_batch_normalization</a>()</code> <br><code><a href="layer_bidirectional.html">layer_bidirectional</a>()</code> <br><code><a href="layer_category_encoding.html">layer_category_encoding</a>()</code> <br><code><a href="layer_center_crop.html">layer_center_crop</a>()</code> <br><code><a href="layer_concatenate.html">layer_concatenate</a>()</code> <br><code><a href="layer_conv_1d.html">layer_conv_1d</a>()</code> <br><code><a href="layer_conv_1d_transpose.html">layer_conv_1d_transpose</a>()</code> <br><code><a href="layer_conv_2d.html">layer_conv_2d</a>()</code> <br><code><a href="layer_conv_2d_transpose.html">layer_conv_2d_transpose</a>()</code> <br><code><a href="layer_conv_3d.html">layer_conv_3d</a>()</code> <br><code><a href="layer_conv_3d_transpose.html">layer_conv_3d_transpose</a>()</code> <br><code><a href="layer_conv_lstm_1d.html">layer_conv_lstm_1d</a>()</code> <br><code><a href="layer_conv_lstm_2d.html">layer_conv_lstm_2d</a>()</code> <br><code><a href="layer_conv_lstm_3d.html">layer_conv_lstm_3d</a>()</code> <br><code><a href="layer_cropping_1d.html">layer_cropping_1d</a>()</code> <br><code><a href="layer_cropping_2d.html">layer_cropping_2d</a>()</code> <br><code><a href="layer_cropping_3d.html">layer_cropping_3d</a>()</code> <br><code><a href="layer_dense.html">layer_dense</a>()</code> <br><code><a href="layer_depthwise_conv_1d.html">layer_depthwise_conv_1d</a>()</code> <br><code><a href="layer_depthwise_conv_2d.html">layer_depthwise_conv_2d</a>()</code> <br><code><a href="layer_discretization.html">layer_discretization</a>()</code> <br><code><a href="layer_dot.html">layer_dot</a>()</code> <br><code><a href="layer_dropout.html">layer_dropout</a>()</code> <br><code><a href="layer_einsum_dense.html">layer_einsum_dense</a>()</code> <br><code><a href="layer_embedding.html">layer_embedding</a>()</code> <br><code><a href="layer_feature_space.html">layer_feature_space</a>()</code> <br><code><a href="layer_flatten.html">layer_flatten</a>()</code> <br><code><a href="layer_flax_module_wrapper.html">layer_flax_module_wrapper</a>()</code> <br><code><a href="layer_gaussian_dropout.html">layer_gaussian_dropout</a>()</code> <br><code><a href="layer_gaussian_noise.html">layer_gaussian_noise</a>()</code> <br><code><a href="layer_global_average_pooling_1d.html">layer_global_average_pooling_1d</a>()</code> <br><code><a href="layer_global_average_pooling_2d.html">layer_global_average_pooling_2d</a>()</code> <br><code><a href="layer_global_average_pooling_3d.html">layer_global_average_pooling_3d</a>()</code> <br><code><a href="layer_global_max_pooling_1d.html">layer_global_max_pooling_1d</a>()</code> <br><code><a href="layer_global_max_pooling_2d.html">layer_global_max_pooling_2d</a>()</code> <br><code><a href="layer_global_max_pooling_3d.html">layer_global_max_pooling_3d</a>()</code> <br><code><a href="layer_group_normalization.html">layer_group_normalization</a>()</code> <br><code><a href="layer_group_query_attention.html">layer_group_query_attention</a>()</code> <br><code><a href="layer_gru.html">layer_gru</a>()</code> <br><code><a href="layer_hashed_crossing.html">layer_hashed_crossing</a>()</code> <br><code><a href="layer_hashing.html">layer_hashing</a>()</code> <br><code><a href="layer_identity.html">layer_identity</a>()</code> <br><code><a href="layer_jax_model_wrapper.html">layer_jax_model_wrapper</a>()</code> <br><code><a href="layer_lambda.html">layer_lambda</a>()</code> <br><code><a href="layer_layer_normalization.html">layer_layer_normalization</a>()</code> <br><code><a href="layer_lstm.html">layer_lstm</a>()</code> <br><code><a href="layer_masking.html">layer_masking</a>()</code> <br><code><a href="layer_max_pooling_1d.html">layer_max_pooling_1d</a>()</code> <br><code><a href="layer_max_pooling_2d.html">layer_max_pooling_2d</a>()</code> <br><code><a href="layer_max_pooling_3d.html">layer_max_pooling_3d</a>()</code> <br><code><a href="layer_maximum.html">layer_maximum</a>()</code> <br><code><a href="layer_mel_spectrogram.html">layer_mel_spectrogram</a>()</code> <br><code><a href="layer_minimum.html">layer_minimum</a>()</code> <br><code><a href="layer_multi_head_attention.html">layer_multi_head_attention</a>()</code> <br><code><a href="layer_multiply.html">layer_multiply</a>()</code> <br><code><a href="layer_normalization.html">layer_normalization</a>()</code> <br><code><a href="layer_permute.html">layer_permute</a>()</code> <br><code><a href="layer_random_brightness.html">layer_random_brightness</a>()</code> <br><code><a href="layer_random_contrast.html">layer_random_contrast</a>()</code> <br><code><a href="layer_random_crop.html">layer_random_crop</a>()</code> <br><code><a href="layer_random_flip.html">layer_random_flip</a>()</code> <br><code><a href="layer_random_rotation.html">layer_random_rotation</a>()</code> <br><code><a href="layer_random_translation.html">layer_random_translation</a>()</code> <br><code><a href="layer_random_zoom.html">layer_random_zoom</a>()</code> <br><code><a href="layer_repeat_vector.html">layer_repeat_vector</a>()</code> <br><code><a href="layer_rescaling.html">layer_rescaling</a>()</code> <br><code><a href="layer_reshape.html">layer_reshape</a>()</code> <br><code><a href="layer_resizing.html">layer_resizing</a>()</code> <br><code><a href="layer_rnn.html">layer_rnn</a>()</code> <br><code><a href="layer_separable_conv_1d.html">layer_separable_conv_1d</a>()</code> <br><code><a href="layer_separable_conv_2d.html">layer_separable_conv_2d</a>()</code> <br><code><a href="layer_simple_rnn.html">layer_simple_rnn</a>()</code> <br><code><a href="layer_spatial_dropout_1d.html">layer_spatial_dropout_1d</a>()</code> <br><code><a href="layer_spatial_dropout_2d.html">layer_spatial_dropout_2d</a>()</code> <br><code><a href="layer_spatial_dropout_3d.html">layer_spatial_dropout_3d</a>()</code> <br><code><a href="layer_spectral_normalization.html">layer_spectral_normalization</a>()</code> <br><code><a href="layer_string_lookup.html">layer_string_lookup</a>()</code> <br><code><a href="layer_subtract.html">layer_subtract</a>()</code> <br><code><a href="layer_text_vectorization.html">layer_text_vectorization</a>()</code> <br><code><a href="layer_tfsm.html">layer_tfsm</a>()</code> <br><code><a href="layer_time_distributed.html">layer_time_distributed</a>()</code> <br><code><a href="layer_torch_module_wrapper.html">layer_torch_module_wrapper</a>()</code> <br><code><a href="layer_unit_normalization.html">layer_unit_normalization</a>()</code> <br><code><a href="layer_upsampling_1d.html">layer_upsampling_1d</a>()</code> <br><code><a href="layer_upsampling_2d.html">layer_upsampling_2d</a>()</code> <br><code><a href="layer_upsampling_3d.html">layer_upsampling_3d</a>()</code> <br><code><a href="layer_zero_padding_1d.html">layer_zero_padding_1d</a>()</code> <br><code><a href="layer_zero_padding_2d.html">layer_zero_padding_2d</a>()</code> <br><code><a href="layer_zero_padding_3d.html">layer_zero_padding_3d</a>()</code> <br><code><a href="rnn_cell_gru.html">rnn_cell_gru</a>()</code> <br><code><a href="rnn_cell_lstm.html">rnn_cell_lstm</a>()</code> <br><code><a href="rnn_cell_simple.html">rnn_cell_simple</a>()</code> <br><code><a href="rnn_cells_stack.html">rnn_cells_stack</a>()</code> <br></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tomasz Kalinowski, JJ Allaire, François Chollet, Posit Software, PBC, Google.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

