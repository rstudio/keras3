<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Configure a model for training. — compile.keras.src.models.model.Model • keras3</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Configure a model for training. — compile.keras.src.models.model.Model"><meta name="description" content="Configure a model for training."><meta property="og:description" content="Configure a model for training."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">keras3</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/getting_started.html">Getting Started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-guides"><li><h6 class="dropdown-header" data-toc-skip>Model definition</h6></li>
    <li><a class="dropdown-item" href="../articles/sequential_model.html">Sequential Model</a></li>
    <li><a class="dropdown-item" href="../articles/functional_api.html">Functional API</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extending and customizing</h6></li>
    <li><a class="dropdown-item" href="../articles/training_with_built_in_methods.html">Training &amp; evaluation with the built-in methods</a></li>
    <li><a class="dropdown-item" href="../articles/custom_train_step_in_tensorflow.html">Customizing `fit()` with Tensorflow</a></li>
    <li><a class="dropdown-item" href="../articles/writing_your_own_callbacks.html">Writing your own callbacks</a></li>
    <li><a class="dropdown-item" href="../articles/making_new_layers_and_models_via_subclassing.html">Making new layers and models via subclassing</a></li>
    <li><a class="dropdown-item" href="../articles/writing_a_custom_training_loop_in_tensorflow.html">Writing a training loop from scratch in TensorFlow</a></li>
    <li><a class="dropdown-item" href="../articles/serialization_and_saving.html">Serialization and Saving</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other topics</h6></li>
    <li><a class="dropdown-item" href="../articles/transfer_learning.html">Transfer learning and fine tuning</a></li>
    <li><a class="dropdown-item" href="../articles/distributed_training_with_tensorflow.html">Distributed training with TensorFlow</a></li>
    <li><a class="dropdown-item" href="../articles/distribution.html">Distributed training with Jax</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/examples/index.html">Examples</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/keras3/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Configure a model for training.</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/keras3/blob/HEAD/R/model-training.R" class="external-link"><code>R/model-training.R</code></a></small>
      <div class="d-none name"><code>compile.keras.src.models.model.Model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Configure a model for training.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'keras.src.models.model.Model'</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/compile.html" class="external-link">compile</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"rmsprop"</span>,</span>
<span>  loss <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  loss_weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weighted_metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  run_eagerly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  steps_per_execution <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  jit_compile <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  auto_scale_loss <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>Keras model object</p></dd>


<dt id="arg-optimizer">optimizer<a class="anchor" aria-label="anchor" href="#arg-optimizer"></a></dt>
<dd><p>String (name of optimizer) or optimizer instance. See
<code>optimizer_*</code> family.</p></dd>


<dt id="arg-loss">loss<a class="anchor" aria-label="anchor" href="#arg-loss"></a></dt>
<dd><p>Loss function. May be:</p><ul><li><p>a string (name of builtin loss function),</p></li>
<li><p>a custom function, or</p></li>
<li><p>a <code><a href="Loss.html">Loss</a></code> instance (returned by the <code>loss_*</code> family of functions).</p></li>
</ul><p>A loss function is any callable with the signature
<code>loss = fn(y_true, y_pred)</code>, where <code>y_true</code> are the ground truth
values, and <code>y_pred</code> are the model's predictions.
<code>y_true</code> should have shape <code>(batch_size, d1, .. dN)</code>
(except in the case of sparse loss functions such as
sparse categorical crossentropy which expects integer arrays of
shape <code>(batch_size, d1, .. dN-1)</code>).
<code>y_pred</code> should have shape <code>(batch_size, d1, .. dN)</code>.
The loss function should return a float tensor.</p></dd>


<dt id="arg-metrics">metrics<a class="anchor" aria-label="anchor" href="#arg-metrics"></a></dt>
<dd><p>List of metrics to be evaluated by the model during
training and testing. Each of these can be:</p><ul><li><p>a string (name of a
built-in function),</p></li>
<li><p>a function, optionally with a <code>"name"</code> attribute or</p></li>
<li><p>a <code><a href="Metric.html">Metric()</a></code>
instance. See the <code>metric_*</code> family of functions.</p></li>
</ul><p>Typically you will use
<code>metrics = c('accuracy')</code>. A function is any callable with the
signature <code>result = fn(y_true, y_pred)</code>. To specify different
metrics for different outputs of a multi-output model, you could
also pass a named list, such as
<code>metrics = list(a = 'accuracy', b = c('accuracy', 'mse'))</code>.
You can also pass a list to specify a metric or a list of
metrics for each output, such as
<code>metrics = list(c('accuracy'), c('accuracy', 'mse'))</code>
or <code>metrics = list('accuracy', c('accuracy', 'mse'))</code>. When you pass
the strings <code>'accuracy'</code> or <code>'acc'</code>, we convert this to one of
<code><a href="metric_binary_accuracy.html">metric_binary_accuracy()</a></code>,
<code><a href="metric_categorical_accuracy.html">metric_categorical_accuracy()</a></code>,
<code><a href="metric_sparse_categorical_accuracy.html">metric_sparse_categorical_accuracy()</a></code> based on the
shapes of the targets and of the model output. A similar
conversion is done for the strings <code>"crossentropy"</code>
and <code>"ce"</code> as well.
The metrics passed here are evaluated without sample weighting;
if you would like sample weighting to apply, you can specify
your metrics via the <code>weighted_metrics</code> argument instead.</p>
<p>If providing an anonymous R function, you can customize the printed name
during training by assigning <code>attr(&lt;fn&gt;, "name") &lt;- "my_custom_metric_name"</code>,
or by calling <code><a href="custom_metric.html">custom_metric("my_custom_metric_name", &lt;fn&gt;)</a></code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed on to the <code><a href="https://generics.r-lib.org/reference/compile.html" class="external-link">compile()</a></code> model method.</p></dd>


<dt id="arg-loss-weights">loss_weights<a class="anchor" aria-label="anchor" href="#arg-loss-weights"></a></dt>
<dd><p>Optional list (named or unnamed) specifying scalar
coefficients (R numerics) to weight the loss contributions of
different model outputs. The loss value that will be minimized
by the model will then be the <em>weighted sum</em> of all individual
losses, weighted by the <code>loss_weights</code> coefficients.  If an unnamed list,
it is expected to have a 1:1 mapping to the model's outputs. If
a named list, it is expected to map output names (strings) to scalar
coefficients.</p></dd>


<dt id="arg-weighted-metrics">weighted_metrics<a class="anchor" aria-label="anchor" href="#arg-weighted-metrics"></a></dt>
<dd><p>List of metrics to be evaluated and weighted by
<code>sample_weight</code> or <code>class_weight</code> during training and testing.</p></dd>


<dt id="arg-run-eagerly">run_eagerly<a class="anchor" aria-label="anchor" href="#arg-run-eagerly"></a></dt>
<dd><p>Bool. If <code>TRUE</code>, this model's forward pass
will never be compiled. It is recommended to leave this
as <code>FALSE</code> when training (for best performance),
and to set it to <code>TRUE</code> when debugging.</p></dd>


<dt id="arg-steps-per-execution">steps_per_execution<a class="anchor" aria-label="anchor" href="#arg-steps-per-execution"></a></dt>
<dd><p>Int. The number of batches to run
during each a single compiled function call. Running multiple
batches inside a single compiled function call can
greatly improve performance on TPUs or small models with a large
R/Python overhead. At most, one full epoch will be run each
execution. If a number larger than the size of the epoch is
passed, the execution will be truncated to the size of the
epoch. Note that if <code>steps_per_execution</code> is set to <code>N</code>,
<code>Callback$on_batch_begin</code> and <code>Callback$on_batch_end</code> methods
will only be called every <code>N</code> batches (i.e. before/after
each compiled function execution).
Not supported with the PyTorch backend.</p></dd>


<dt id="arg-jit-compile">jit_compile<a class="anchor" aria-label="anchor" href="#arg-jit-compile"></a></dt>
<dd><p>Bool or <code>"auto"</code>. Whether to use XLA compilation when
compiling a model. For <code>jax</code> and <code>tensorflow</code> backends,
<code>jit_compile="auto"</code> enables XLA compilation if the model
supports it, and disabled otherwise.
For <code>torch</code> backend, <code>"auto"</code> will default to eager
execution and <code>jit_compile=True</code> will run with <code>torch.compile</code>
with the <code>"inductor"</code> backend.</p></dd>


<dt id="arg-auto-scale-loss">auto_scale_loss<a class="anchor" aria-label="anchor" href="#arg-auto-scale-loss"></a></dt>
<dd><p>Bool. If <code>TRUE</code> and the model dtype policy is
<code>"mixed_float16"</code>, the passed optimizer will be automatically
wrapped in a <code>LossScaleOptimizer</code>, which will dynamically
scale the loss to prevent underflow.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This is called primarily for the side effect of modifying <code>object</code>
in-place. The first argument <code>object</code> is also returned, invisibly, to
enable usage with the pipe.</p>
    </div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>
    <p></p><div class="sourceCode r"><pre><code><span><span class="va">model</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://generics.r-lib.org/reference/compile.html" class="external-link">compile</a></span><span class="op">(</span></span>
<span>  optimizer <span class="op">=</span> <span class="fu"><a href="../reference/optimizer_adam.html">optimizer_adam</a></span><span class="op">(</span>learning_rate <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span>,</span>
<span>  loss <span class="op">=</span> <span class="fu"><a href="../reference/loss_binary_crossentropy.html">loss_binary_crossentropy</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/metric_binary_accuracy.html">metric_binary_accuracy</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="../reference/metric_false_negatives.html">metric_false_negatives</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><a href="https://keras.io/api/models/model_training_apis#compile-method" class="external-link">https://keras.io/api/models/model_training_apis#compile-method</a></p></li>
</ul><p>Other model training: <br><code><a href="evaluate.keras.src.models.model.Model.html">evaluate.keras.src.models.model.Model</a>()</code> <br><code><a href="predict.keras.src.models.model.Model.html">predict.keras.src.models.model.Model</a>()</code> <br><code><a href="predict_on_batch.html">predict_on_batch</a>()</code> <br><code><a href="test_on_batch.html">test_on_batch</a>()</code> <br><code><a href="train_on_batch.html">train_on_batch</a>()</code> <br></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tomasz Kalinowski, JJ Allaire, François Chollet, Posit Software, PBC, Google.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>

    </footer></div>





  </body></html>

